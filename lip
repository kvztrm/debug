-- Aggressive Trident Scanner
-- Put this in StarterPlayerScripts (LocalScript) or ServerScriptService (Script)

local keywords = {
    "trident",
    "tridentwave",
    "tridentwavehitbox",
    "tridentwaves",
    "trident wave",
    "wavehitbox",
    -- add more variations if needed
}

-- Case-insensitive search
local function containsKeyword(text)
    local lower = text:lower()
    for _, kw in ipairs(keywords) do
        if lower:find(kw:lower(), 1, true) then
            return true, kw
        end
    end
    return false
end

-- Get short but useful path
local function getScriptPath(obj)
    local path = {}
    local current = obj
    while current and current ~= game do
        table.insert(path, 1, current.Name)
        current = current.Parent
    end
    return table.concat(path, " → ")
end

-- Main scanning function
local function scanScript(scriptObj)
    if not scriptObj:IsA("LuaSourceContainer") then
        return
    end

    local success, source = pcall(function()
        -- Try most common ways to get source
        if getscriptsource then
            return getscriptsource(scriptObj)
        elseif decompile then
            return decompile(scriptObj)
        elseif scriptObj.Source then
            return scriptObj.Source
        else
            return "-- source not readable"
        end
    end)

    if not success or not source or source == "" then
        print("× Could not read source:", getScriptPath(scriptObj))
        return
    end

    local lines = {}
    for line in (source .. "\n"):gmatch("(.-)\n") do
        table.insert(lines, line)
    end

    local foundAny = false

    for i, line in ipairs(lines) do
        local hasKw, which = containsKeyword(line)
        if hasKw then
            if not foundAny then
                print("\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━")
                print("MATCH FOUND in:", getScriptPath(scriptObj))
                print("Script class:", scriptObj.ClassName)
                print("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━")
                foundAny = true
            end

            -- Show context: line number + the line itself
            print(string.format("[%04d]  %s", i, line))
        end
    end

    if foundAny then
        print("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n")
    end
end

-- Scan everything
local function scanAll()
    print("Starting aggressive trident scan...")

    local totalScanned = 0
    local matchesFound = 0

    -- Scan ReplicatedStorage, ServerScriptService, StarterPlayerScripts, etc.
    local containers = {
        game:GetService("ReplicatedStorage"),
        game:GetService("ServerScriptService"),
        game:GetService("StarterPlayer").StarterPlayerScripts,
        game:GetService("StarterGui"),
        game:GetService("Players").LocalPlayer:WaitForChild("PlayerScripts", 5),
        game:GetService("Workspace"),
        game:GetService("Lighting"),
        game:GetService("Chat"),
    }

    for _, container in ipairs(containers) do
        if not container then continue end

        for _, obj in ipairs(container:GetDescendants()) do
            if obj:IsA("LuaSourceContainer") then
                totalScanned = totalScanned + 1
                local success, err = pcall(scanScript, obj)
                if success and err then
                    matchesFound = matchesFound + 1
                end
            end
        end
    end

    print("\nScan finished!")
    print("Total scripts scanned:", totalScanned)
    print("Scripts with matches:", matchesFound)
end

-- Run the scan
scanAll()

-- Optional: re-scan every few seconds (useful if scripts load late)
-- while true do
--     task.wait(6)
--     print("\nRe-scanning...")
--     scanAll()
-- end
