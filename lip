-- Workspace Anti-Cheat / Suspicious Object Scanner
-- Scans workspace for common anti-cheat signs, monitoring scripts, protection objects, etc.
-- Prints full paths and details to console

local Workspace = game:GetService("Workspace")
local Players = game:GetService("Players")

-- Common suspicious keywords (case-insensitive)
local suspiciousKeywords = {
    "anticheat", "anti", "anticheat", "exploit", "cheat", "protect", "monitor", "guard", "hook", 
    "detection", "ban", "kick", "remote", "validate", "integrity", "tamper", "noclip", "fly", 
    "speed", "teleport", "dex", "explorer", "synapse", "krnl", "scriptx", "visionary", "knightmare",
    "cloud", "hash", "metatable", "hookfunction", "gethui", "coregui", "valkyrie"
}

-- Common suspicious class names or patterns
local suspiciousClasses = {
    "Script", "LocalScript", "ModuleScript", "BindableEvent", "BindableFunction",
    "RemoteEvent", "RemoteFunction"  -- especially if many in workspace
}

-- Helper: Get full path of an instance
local function getFullPath(instance)
    local path = {}
    local current = instance
    while current and current ~= game do
        table.insert(path, 1, current.Name)
        current = current.Parent
    end
    return table.concat(path, " → ")
end

-- Helper: Check if name contains any keyword
local function isSuspiciousName(name)
    local lowerName = name:lower()
    for _, kw in ipairs(suspiciousKeywords) do
        if lowerName:find(kw) then
            return true
        end
    end
    return false
end

-- Main scan function
local function scanWorkspace()
    print("──────────────────────────────────────────────────────────────")
    print("WORKSPACE SCAN STARTED - Looking for potential anti-cheat / monitoring objects")
    print("Date: " .. os.date("%Y-%m-%d %H:%M:%S"))
    print("Player: " .. Players.LocalPlayer.Name)
    print("──────────────────────────────────────────────────────────────")

    local count = 0

    local function recursiveScan(parent)
        for _, obj in ipairs(parent:GetChildren()) do
            local isSus = false
            local reason = {}

            -- Name-based suspicion
            if isSuspiciousName(obj.Name) then
                isSus = true
                table.insert(reason, "Suspicious name keyword")
            end

            -- Class-based suspicion
            for _, class in ipairs(suspiciousClasses) do
                if obj:IsA(class) then
                    table.insert(reason, "Class: " .. obj.ClassName)
                    isSus = true
                    break
                end
            end

            -- Extra checks for scripts
            if obj:IsA("BaseScript") then
                if obj.Disabled then
                    table.insert(reason, "Disabled script")
                end
                -- If you want to see source (only if not protected)
                -- pcall(function()
                --     if obj.Source ~= "" then
                --         table.insert(reason, "Has source code")
                --     end
                -- end)
            end

            -- Print if suspicious
            if isSus then
                count = count + 1
                local path = getFullPath(obj)
                local extra = table.concat(reason, ", ")
                print(string.format(
                    "[%d]  %s  |  Class: %s  |  Path: %s  |  Flags: %s",
                    count, obj.Name, obj.ClassName, path, extra
                ))
            end

            -- Recurse deeper
            recursiveScan(obj)
        end
    end

    -- Start scanning from Workspace
    recursiveScan(Workspace)

    print("──────────────────────────────────────────────────────────────")
    print("Scan finished. Found " .. count .. " potentially suspicious items.")
    print("Note: Many legitimate objects can match (e.g. 'RemoteEvent'). Use judgment.")
    print("Common anti-cheat signs: Scripts named 'AntiCheat', 'Monitor', 'Protect*', etc.")
    print("──────────────────────────────────────────────────────────────\n")
end

-- Run the scan immediately
scanWorkspace()

-- Optional: Re-scan every 30 seconds (uncomment if you want continuous monitoring)
-- while true do
--     task.wait(30)
--     scanWorkspace()
-- end
