local Iris = loadstring(game:HttpGet("https://raw.githubusercontent.com/x0581/Iris-Exploit-Bundle/2.0.4/bundle.lua"))().Init(game.CoreGui)

local autoKillEnabled = Iris.State(false)

local GetService = setmetatable({}, {
	__index = function(Self, Name)
		Self[Name] = game:GetService(Name)
		return Self[Name]
	end
})

local Players = GetService.Players
local ReplicatedStorage = GetService.ReplicatedStorage
local RunService = GetService.RunService
local Workspace = GetService.Workspace
local LocalPlayer = Players.LocalPlayer

local RemoteEvent = nil

local function FindRemoteEvent()
    local paths = {
        ReplicatedStorage:FindFirstChild("Events") and ReplicatedStorage.Events:FindFirstChild("RemoteEvent"),
        ReplicatedStorage:FindFirstChild("Remote"),
        ReplicatedStorage:FindFirstChild("RF") and ReplicatedStorage.RF:FindFirstChild("RemoteEvent"),
        ReplicatedStorage:FindFirstChild("Remotes") and ReplicatedStorage.Remotes:FindFirstChild("RemoteEvent"),
        ReplicatedStorage:FindFirstChild("Network") and ReplicatedStorage.Network:FindFirstChild("RemoteEvent")
    }
    
    for _, remote in pairs(paths) do
        if remote and remote:IsA("RemoteEvent") then
            RemoteEvent = remote
            return true
        end
    end
    return false
end

FindRemoteEvent()

local Pickups = Workspace:WaitForChild("pickups")
local TheTarget = nil

local function GetRandomSkyPosition()
    local dist = math.random(5000000, 15000000)
    local angle = math.random() * math.pi * 2
    
    local x = math.cos(angle) * dist
    local z = math.sin(angle) * dist
    local y = math.random(25000, 75000)
    
    return Vector3.new(x, y, z)
end

-- Autokill control variables
local autokillConnection = nil
local lastEnabledState = false

-- Poll state every frame (this bundle has no .changed event)
RunService.Heartbeat:Connect(function()
    local currentEnabled = autoKillEnabled:get()
    
    if currentEnabled ~= lastEnabledState then
        lastEnabledState = currentEnabled
        
        if currentEnabled then
            -- Start autokill
            if autokillConnection then
                autokillConnection:Disconnect()
            end
            
            autokillConnection = RunService.Heartbeat:Connect(function()
                local MyChar = LocalPlayer.Character
                if not MyChar then return end
                
                local Humanoid = MyChar:FindFirstChildOfClass("Humanoid")
                local Root = MyChar:FindFirstChild("HumanoidRootPart")
                if not Humanoid or not Root then return end
                
                if Humanoid.Sit then Humanoid.Sit = false end
                if Root.Anchored then Root.Anchored = false end
                
                local Backpack = LocalPlayer:FindFirstChild("Backpack")
                local HasKnife = (MyChar:FindFirstChild("Knife")) or (Backpack and Backpack:FindFirstChild("Knife"))
                
                if not HasKnife then
                    for _, Pickup in pairs(Pickups:GetChildren()) do
                        if Pickup.Name == "Knife" then
                            local MeshPart = Pickup:FindFirstChild("Meshes/knife1")
                            if MeshPart and MeshPart:IsA("BasePart") and MeshPart.Parent then
                                Root.CFrame = CFrame.new(MeshPart.Position)
                                task.wait(0.2)
                                
                                if RemoteEvent then
                                    RemoteEvent:FireServer(12, Pickup)
                                end
                                task.wait(0.2)
                                break
                            end
                        end
                    end
                    return
                end
                
                local Knife = MyChar:FindFirstChild("Knife") or (Backpack and Backpack:FindFirstChild("Knife"))
                if not Knife then return end
                
                if TheTarget and TheTarget.Parent then
                    local TargetChar = TheTarget.Character
                    if TargetChar then
                        local TargetRoot = TargetChar:FindFirstChild("HumanoidRootPart")
                        local TargetHead = TargetChar:FindFirstChild("Head")
                        local TargetHumanoid = TargetChar:FindFirstChildOfClass("Humanoid")
                        local ForceField = TargetChar:FindFirstChildOfClass("ForceField")
                        
                        if TargetRoot and TargetHead and TargetHumanoid and TargetHumanoid.Health > 0 and not ForceField then
                            local MyTeam = LocalPlayer.Team
                            local TargetTeam = TheTarget.Team
                            local IsPolice = MyTeam and MyTeam.Name == "Police"
                            local TargetIsPolice = TargetTeam and TargetTeam.Name == "Police"
                            
                            Root.CFrame = TargetRoot.CFrame * CFrame.new(0, -6, 0)
                            
                            if IsPolice and TargetIsPolice then
                                if Knife.Parent == MyChar then
                                    pcall(function() Humanoid:UnequipTools() end)
                                end
                                if (Root.Position - TargetRoot.Position).Magnitude <= 17 then
                                    if RemoteEvent then
                                        RemoteEvent:FireServer(33, TargetHead)
                                    end
                                end
                            else
                                if Knife.Parent == Backpack then
                                    pcall(function() Humanoid:EquipTool(Knife) end)
                                end
                                if (Root.Position - TargetRoot.Position).Magnitude <= 37 then
                                    local Direction = (TargetHead.Position - Root.Position).Unit
                                    if RemoteEvent then
                                        RemoteEvent:FireServer(16, Knife, TargetHead, Direction)
                                    end
                                end
                            end
                            return
                        end
                    end
                end
                
                TheTarget = nil
                
                for _, Player in pairs(Players:GetPlayers()) do
                    if Player ~= LocalPlayer then
                        local TargetChar = Player.Character
                        if TargetChar then
                            local TargetHumanoid = TargetChar:FindFirstChildOfClass("Humanoid")
                            local ForceField = TargetChar:FindFirstChildOfClass("ForceField")
                            if TargetHumanoid and TargetHumanoid.Health > 0 and not ForceField then
                                TheTarget = Player
                                break
                            end
                        end
                    end
                end
                
                if not TheTarget then
                    local skyPos = GetRandomSkyPosition()
                    Root.CFrame = CFrame.new(skyPos)
                    task.wait(math.random(3, 6) / 10)
                end
            end)
        else
            -- Stop autokill
            if autokillConnection then
                autokillConnection:Disconnect()
                autokillConnection = nil
            end
            TheTarget = nil
        end
    end
end)

Iris:Connect(function()
    Iris.Window({"LIFE IN PRISON"})
    
    Iris.Tree({"MAIN"})
        Iris.Checkbox({"AUTOKILL TOGGLE"}, {isChecked = autoKillEnabled})
        Iris.Text({"AUTOKILL: " .. (autoKillEnabled:get() and "ENABLED" or "DISABLED")})
    Iris.End()
    
    Iris.End()
end)
