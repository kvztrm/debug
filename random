-- Aimbot - Lock to closest player to mouse
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local Mouse = LocalPlayer:GetMouse()

local enabled = false
local target = nil

function findClosestToMouse()
    local closest, closestDist = nil, 1000
    for _, p in ipairs(Players:GetPlayers()) do
        if p ~= LocalPlayer and p.Character then
            local root = p.Character:FindFirstChild("HumanoidRootPart")
            local head = p.Character:FindFirstChild("Head")
            if root and head then
                local dist = (root.Position - Mouse.Hit.p).Magnitude
                if dist < closestDist then
                    closestDist = dist
                    closest = p
                end
            end
        end
    end
    return closest
end

function aimAtPlayer(player)
    if not player or not player.Character then return end
    local part = player.Character:FindFirstChild("Head") or player.Character:FindFirstChild("HumanoidRootPart")
    if part then
        Camera.CFrame = CFrame.new(Camera.CFrame.Position, part.Position)
        Mouse.Hit = CFrame.new(part.Position)
    end
end

UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.Q and input.UserInputType == Enum.UserInputType.Keyboard then
        enabled = not enabled
        
        if enabled then
            target = findClosestToMouse()
            if target then
                for i = 1, 10 do
                    aimAtPlayer(target)
                    task.wait(0.001)
                end
            else
                enabled = false
            end
        else
            target = nil
        end
    end
end)

RunService.RenderStepped:Connect(function()
    if enabled then
        -- Find closest to mouse
        target = findClosestToMouse()
        if target then
            aimAtPlayer(target)
        end
    end
end)
