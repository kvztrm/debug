-- Quick Copy - Camera resets to head lock after copy

local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local Camera = Workspace.CurrentCamera
local LocalPlayer = Players.LocalPlayer

-- Force camera to lock to head
local function lockToHead()
    local char = LocalPlayer.Character
    if not char then return end
    
    local head = char:FindFirstChild("Head")
    local hrp = char:FindFirstChild("HumanoidRootPart")
    
    if not head or not hrp then return end
    
    -- Take camera
    Camera.CameraType = Enum.CameraType.Scriptable
    Camera.CameraSubject = head
    
    -- Position behind head
    local offset = CFrame.new(0, 2, -6)
    Camera.CFrame = hrp.CFrame * offset
    Camera.Focus = hrp.CFrame
    
    -- Switch to custom to lock
    Camera.CameraType = Enum.CameraType.Custom
    
    -- Extra safety
    pcall(function() Camera.HeadLocked = true end)
end

-- Copy your character and reset camera to head
local function copyMe()
    Camera.CameraType = Enum.CameraType.Scriptable
    
    local char = LocalPlayer.Character
    if not char then return end
    
    for _, part in pairs(char:GetChildren()) do
        if part:IsA("BasePart") then
            local clone = part:Clone()
            clone.CFrame = clone.CFrame + Vector3.new(10, 0, 0)
            clone.Parent = Workspace
        end
    end
    
    -- Reset camera to head lock
    task.delay(0.03, lockToHead)
end

-- Copy player by name and reset camera
local function copyPlayer(name)
    Camera.CameraType = Enum.CameraType.Scriptable
    
    local player = Players:FindFirstChild(name)
    if not player or not player.Character then
        lockToHead()
        return
    end
    
    for _, part in pairs(player.Character:GetChildren()) do
        if part:IsA("BasePart") then
            local clone = part:Clone()
            clone.Parent = Workspace
        end
    end
    
    task.delay(0.03, lockToHead)
end

-- Copy all players and reset camera
local function copyAll()
    Camera.CameraType = Enum.CameraType.Scriptable
    
    for _, plr in pairs(Players:GetPlayers()) do
        if plr.Character then
            for _, part in pairs(plr.Character:GetChildren()) do
                if part:IsA("BasePart") then
                    local clone = part:Clone()
                    clone.Parent = Workspace
                end
            end
        end
    end
    
    task.delay(0.03, lockToHead)
end

-- Copy map and reset camera
local function copyMap()
    Camera.CameraType = Enum.CameraType.Scriptable
    
    for _, obj in pairs(Workspace:GetChildren()) do
        if obj:IsA("BasePart") and not obj:IsDescendantOf(Players) then
            local clone = obj:Clone()
            clone.Parent = Workspace
        end
    end
    
    task.delay(0.03, lockToHead)
end

-- Teleport and reset camera
local function tpTo(pos)
    Camera.CameraType = Enum.CameraType.Scriptable
    
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        char.HumanoidRootPart.CFrame = CFrame.new(pos)
    end
    
    task.delay(0.03, lockToHead)
end

-- Copy with offset and reset camera
local function copyOffset(x, y, z)
    Camera.CameraType = Enum.CameraType.Scriptable
    
    local char = LocalPlayer.Character
    if not char then return end
    
    local offset = Vector3.new(x or 10, y or 0, z or 0)
    
    for _, part in pairs(char:GetChildren()) do
        if part:IsA("BasePart") then
            local clone = part:Clone()
            clone.CFrame = clone.CFrame + offset
            clone.Parent = Workspace
        end
    end
    
    task.delay(0.03, lockToHead)
end

-- Fix camera if stuck
local function fixCam()
    lockToHead()
end

-- Deep copy everything
local function deepCopy()
    Camera.CameraType = Enum.CameraType.Scriptable
    
    local char = LocalPlayer.Character
    if not char then return end
    
    for _, part in pairs(char:GetChildren()) do
        local clone = part:Clone()
        clone.Parent = Workspace
    end
    
    task.delay(0.03, lockToHead)
end

-- Usage:
-- copyMe() - Copy yourself
-- copyPlayer("PlayerName") - Copy specific player
-- copyAll() - Copy all players
-- copyMap() - Copy map
-- tpTo(Vector3.new(0, 50, 0)) - Teleport
-- copyOffset(20, 5, 20) - Copy with offset
-- fixCam() - Fix camera if stuck
-- deepCopy() - Full copy

return {
    copyMe = copyMe,
    copyPlayer = copyPlayer,
    copyAll = copyAll,
    copyMap = copyMap,
    tpTo = tpTo,
    copyOffset = copyOffset,
    fixCam = fixCam,
    deepCopy = deepCopy,
    lockToHead = lockToHead
}
